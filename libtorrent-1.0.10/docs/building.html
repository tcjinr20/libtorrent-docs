<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.12: http://docutils.sourceforge.net/" />
<title>libtorrent manual</title>
<meta name="author" content="Arvid Norberg, arvid&#64;libtorrent.org" />
<meta name=viewport content="width=device-width, initial-scale=1">
<script type="text/javascript">
/* <![CDATA[ */
    (function() {
        var s = document.createElement('script'), t = document.getElementsByTagName('script')[0];
        s.type = 'text/javascript';
        s.async = true;
        s.src = 'http://api.flattr.com/js/0.6/load.js?mode=auto';
        t.parentNode.insertBefore(s, t);
    })();
/* ]]> */
</script>
<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" type="text/css" href="rst.css" />
<style type="text/css">
/* Hides from IE-mac \*/
* html pre { height: 1%; }
/* End hide from IE-mac */
</style>
</head>
<body>
<div class="document" id="libtorrent-manual">
    <div id="container">
    <table id="header">
    <tr><td id="orange"></td>
    <td id="logo">libtorrent</td></tr>
    </table>
    <div id="main">
<h1 class="title">libtorrent manual</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr><th class="docinfo-name">Author:</th>
<td>Arvid Norberg, <a class="last reference external" href="mailto:arvid&#64;libtorrent.org">arvid&#64;libtorrent.org</a></td></tr>
<tr><th class="docinfo-name">Version:</th>
<td>1.0.10</td></tr>
</tbody>
</table>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of contents</p>
<ul class="simple">
<li><a class="reference internal" href="#downloading-and-building" id="id8">downloading and building</a><ul>
<li><a class="reference internal" href="#building-from-svn" id="id9">building from svn</a></li>
<li><a class="reference internal" href="#building-with-bbv2" id="id10">building with BBv2</a></li>
<li><a class="reference internal" href="#building-with-autotools" id="id11">building with autotools</a></li>
<li><a class="reference internal" href="#building-with-other-build-systems" id="id12">building with other build systems</a></li>
<li><a class="reference internal" href="#build-configurations" id="id13">build configurations</a></li>
<li><a class="reference internal" href="#building-openssl-for-windows" id="id14">building openssl for windows</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="downloading-and-building">
<h1>downloading and building (下载和构建)</h1>
<p>To acquire the latest version of libtorrent, you'll have to grab it from SVN.
You'll find instructions on how to do this <a class="reference external" href="http://sourceforge.net/svn/?group_id=79942">here</a> (see subversion access).</p>
<p><font color="#0000E3">你可以从 SVN 获取最新版本的 libtorrent.
你可以看到说明在 <a class="reference external" href="http://sourceforge.net/svn/?group_id=79942">这里</a> (查看 subversion 权限控制).</font></p>
<p>The build systems supported &quot;out of the box&quot; in libtorrent are boost-build v2
(BBv2) and autotools (for unix-like systems). If you still can't build after
following these instructions, you can usually get help in the <tt class="docutils literal">#libtorrent</tt>
IRC channel on <tt class="docutils literal">irc.freenode.net</tt>.</p>
<p><font color="#0000E3">构建系统支持 &quot;out of the box&quot; 在 libtorrent 中有 boost-build v2
(BBv2) 以及 autotools (提供给 unix-like 操作系统). 如果根据说明你仍然无法构建的话, 你通常可以在 <tt class="docutils literal">irc.freenode.net</tt> 的 <tt class="docutils literal">#libtorrent</tt>
IRC 频道获取帮助.</font></p>
<div class="warning">
<p class="first admonition-title">Warning (警告)</p>
<p>A common mistake when building and linking against libtorrent is
to build with one set of configuration options (#defines) and
link against it using a different set of configuration options. Since
libtorrent has some code in header files, that code will not be
compatible with the built library if they see different configurations.</p>
<p><font color="#0000E3">构建和链接 libtorrent 库时常见的错误是构建的配置项(通过#defines来配置)和链接的配置项不一致. 由于
libtorrent 有部分源码写在头文件里面, 因此这些代码将无法和构建的库兼容, 如果说两者配置项不一致的话.</font></p>
<p>Always make sure that the same TORRENT_* macros are defined when you
link against libtorrent as when you build it.</p>
<p><font color="#0000E3">务必确保链接时使用和构建时相同的 TORRENT_* 宏定义.</font></p>
<p class="last">Boost-build supports propagating configuration options to dependencies.
When building using the makefiles, this is handled by setting the
configuration options in the pkg-config file. Always use pkg-config
when linking against libtorrent.</p>
<p class="last"><font color="#0000E3">Boost-build 支持共享依赖配置项.
使用 Makefiles 构建时, 这些配置项会通过 pkg-config 文件被处理. 链接 libtorrent 时可以使用 pkg-config.</font></p>
</div>
<div class="section" id="building-from-svn">
<h2>building from svn (从 SVN 构建)</h2>
<p>To build libtorrent from svn you need to check out the libtorrent sources from
sourceforge. If you downloaded a release tarball, you can skip this section.</p>
<p><font color="#0000E3">从 SVN 构建 libtorrent 的话需要从 sourceforge 检出 libtorrent 的源码. 
	如果下载释出的 tar 包的话, 可以跳过这一步.</font></p>
<p>To check out libtorrent follow these <a class="reference external" href="http://sourceforge.net/svn/?group_id=79942">instructions</a>.</p>
<p><font color="#0000E3">检出 libtorrent 源码请参见这里的 <a class="reference external" href="http://sourceforge.net/svn/?group_id=79942">说明</a>.</font></p>
</div>
<div class="section" id="building-with-bbv2">
<h2>building with BBv2 (使用 BBv2 构建)</h2>
<p>The primary reason to use boost-build is that it will automatically build the
dependent boost libraries with the correct compiler settings, in order to
ensure that the build targets are link compatible (see <a class="reference external" href="http://boost.org/more/separate_compilation.html">boost guidelines</a>
for some details on this issue).</p>
<p><font color="#0000E3">使用 boost-build 主要是因为这样可以使用正确的编译选项自动构建依赖的 boost 库, 可以确保构建目标和链接兼容 (详见 <a class="reference external" href="http://boost.org/more/separate_compilation.html">boost 指南</a>
关于这个问题的一些细节).</font></p>
<p>Since BBv2 will build the boost libraries for you, you need the full boost
source package. Having boost installed via some package system is usually not
enough (and even if it is enough, the necessary environment variables are
usually not set by the package installer).</p>
<p><font color="#0000E3">由于 BBv2 会构建 boost 库, 所以你需要完整的 boost 源码包. 
	通过一些软件包系统的安装的 boost, 通常是不够的 (即使是够的, 必要的环境变量通常没有设置).</font></p>
<p>If you want to build against an installed copy of boost, you can skip directly
to step 3 (assuming you also have boost build installed).</p>
<p><font color="#0000E3">如果你已经安装好 boost, 可以直接跳到步骤3 (假定你也已经安装 boost 构建工具).</font></p>
<div class="section" id="step-1-download-boost">
<h3>Step 1: Download boost (步骤1: 下载 boost)</h3>
<p>You'll find boost <a class="reference external" href="http://sourceforge.net/project/showfiles.php?group_id=7586&amp;package_id=8041&amp;release_id=619445">here</a>.</p>
<p><font color="#0000E3">你可以找到 boost 在 <a class="reference external" href="http://sourceforge.net/project/showfiles.php?group_id=7586&amp;package_id=8041&amp;release_id=619445">这里</a>.</font></p>
<p>Extract the archive to some directory where you want it. For the sake of this
guide, let's assume you extract the package to <tt class="docutils literal"><span class="pre">c:\boost_1_34_0</span></tt> (I'm using
a windows path in this example since if you're on linux/unix you're more likely
to use the autotools). You'll need at least version 1.34 of the boost library
in order to build libtorrent.</p>
<p><font color="#0000E3">解压源码包到你指定的某个目录. 在这里, 让我们假定解压到 <tt class="docutils literal"><span class="pre">c:\boost_1_34_0</span></tt> (这里我以 Windows 目录为例, 如果你使用 linux 或者 unix 的话推荐使用 autotools). 构建 libtorrent 的 boost 库最低版本要求是 1.34.</font></p>
</div>
<div class="section" id="step-2-setup-bbv2">
<h3>Step 2: Setup BBv2 (步骤2: 安装 BBv2)</h3>
<p>First you need to build <tt class="docutils literal">bjam</tt>. You do this by opening a terminal (In
windows, run <tt class="docutils literal">cmd</tt>). Change directory to
<tt class="docutils literal"><span class="pre">c:\boost_1_34_0\tools\jam\src</span></tt>. Then run the script called
<tt class="docutils literal">build.bat</tt> or <tt class="docutils literal">build.sh</tt> on a unix system. This will build <tt class="docutils literal">bjam</tt> and
place it in a directory starting with <tt class="docutils literal">bin.</tt> and then have the name of your
platform. Copy the <tt class="docutils literal">bjam.exe</tt> (or <tt class="docutils literal">bjam</tt> on a unix system) to a place
that's in you shell's <tt class="docutils literal">PATH</tt>. On linux systems a place commonly used may be
<tt class="docutils literal">/usr/local/bin</tt> or on windows <tt class="docutils literal"><span class="pre">c:\windows</span></tt> (you can also add directories
to the search paths by modifying the environment variable called <tt class="docutils literal">PATH</tt>).</p>
<p><font color="#0000E3">首先你需要构建 <tt class="docutils literal">bjam</tt>. 打开终端 (在 Windows 下, 运行 <tt class="docutils literal">cmd</tt>). 切换目录到
<tt class="docutils literal"><span class="pre">c:\boost_1_34_0\tools\jam\src</span></tt>. 然后执行
<tt class="docutils literal">build.bat</tt> 或者 <tt class="docutils literal">build.sh</tt> 如果是 unix 系统. 这将构建 <tt class="docutils literal">bjam</tt> 然后
放置于以 <tt class="docutils literal">bin.</tt> 开头的目录并且以你的平台命名. 复制 <tt class="docutils literal">bjam.exe</tt> (或者 <tt class="docutils literal">bjam</tt> 如果是 unix 系统) 到你当前 Shell 的
<tt class="docutils literal">PATH</tt>. 在 linux 系统上通常使用
<tt class="docutils literal">/usr/local/bin</tt> 或者在 Windows 上的<tt class="docutils literal"><span class="pre">c:\windows</span></tt> (你也可以添加路径到环境变量 <tt class="docutils literal">PATH</tt>).</font></p>
<p>Now you have <tt class="docutils literal">bjam</tt> installed. <tt class="docutils literal">bjam</tt> can be considered an interpreter
that the boost-build system is implemented on. So boost-build uses <tt class="docutils literal">bjam</tt>.
So, to complete the installation you need to make two more things. You need to
set the environment variable <tt class="docutils literal">BOOST_BUILD_PATH</tt>. This is the path that tells
<tt class="docutils literal">bjam</tt> where it can find boost-build, your configuration file and all the
toolsets (descriptions used by boost-build to know how to use different
compilers on different platforms). Assuming the boost install path above, set
it to <tt class="docutils literal"><span class="pre">c:\boost_1_34_0\tools\build\v2</span></tt>.</p>
<p><font color="#0000E3">现在你已经安装完 <tt class="docutils literal">bjam</tt>. <tt class="docutils literal">bjam</tt> 可以认为是 boost-build 系统上实现的一个解释程序. 所以 boost-build 使用 <tt class="docutils literal">bjam</tt>.
那么, 为了完成安装你还有些事情需要做. 你需要设置环境变量
 <tt class="docutils literal">BOOST_BUILD_PATH</tt>. 这个路径可以让
<tt class="docutils literal">bjam</tt> 知道从哪里找到 boost-build, 你的配置文件以及所有的工具集 (用于描述 boost-build 如何在不同平台上使用不同的编译器). 假定 boost 安装路径为前面提到的, 设置
为 <tt class="docutils literal"><span class="pre">c:\boost_1_34_0\tools\build\v2</span></tt>.</font></p>
<p>To set an environment variable in windows, type for example:</p>
<p><font color="#0000E3">在 Windows 上设置环境变量, 敲如下命令:</font></p>
<pre class="literal-block">
set BOOST_BUILD_PATH=c:\boost_1_34_0\tools\build\v2
</pre>
<p>In a terminal window.</p>
<p><font color="#0000E3">在终端窗口上.</font></p>
<p>The last thing to do to complete the setup of BBv2 is to modify your
<tt class="docutils literal"><span class="pre">user-config.jam</span></tt> file. It is located in <tt class="docutils literal"><span class="pre">c:\boost_1_34_0\tools\build\v2</span></tt>.
Depending on your platform and which compiler you're using, you should add a
line for each compiler and compiler version you have installed on your system
that you want to be able to use with BBv2. For example, if you're using
Microsoft Visual Studio 7.1 (2003), just add a line:</p>
<p><font color="#0000E3">安装 BBv2 的最后一件事情是编辑你的
<tt class="docutils literal"><span class="pre">user-config.jam</span></tt> 文件. 它在 <tt class="docutils literal"><span class="pre">c:\boost_1_34_0\tools\build\v2</span></tt>.
根据你所在的平台以及你使用的编译器, 你需要添加一行来说明你的编译器及其版本然后你才能使用 BBv2. 例如, 如果你正在使用
Microsoft Visual Studio 7.1 (2003), 只需添加如下一行:</font></p>
<pre class="literal-block">
using msvc : 7.1 ;
</pre>
<p>If you use GCC, add the line:</p>
<p><font color="#0000E3">如果你使用 GCC, 添加如下一行:</font></p>
<pre class="literal-block">
using gcc ;
</pre>
<p>If you have more than one version of GCC installed, you can add the
commandline used to invoke g++ after the version number, like this:</p>
<p><font color="#0000E3">如果你安装了多个版本的 GCC, 你可以在版本后面添加命令去指定要使用的具体版本的 g++ , 例如:</font></p>
<pre class="literal-block">
using gcc : 3.3 : g++-3.3 ;
using gcc : 4.0 : g++-4.0 ;
</pre>
<p>Another toolset worth mentioning is the <tt class="docutils literal">darwin</tt> toolset (For MacOS X).
From Tiger (10.4) MacOS X comes with both GCC 3.3 and GCC 4.0. Then you can
use the following toolsets:</p>
<p><font color="#0000E3">其他的工具集值得一提的是 <tt class="docutils literal">darwin</tt> 工具集 (用于 MacOS X).
从 Tiger (10.4) MacOS X 开始可以使用 GCC 3.3 和 GCC 4.0. 你可以使用以下工具集:</font></p>
<pre class="literal-block">
using darwin : 3.3 : g++-3.3 ;
using darwin : 4.0 : g++-4.0 ;
</pre>
<p>Note that the spaces around the semi-colons and colons are important!</p>
<p><font color="#0000E3">要特别注意分号和冒号旁边的空格!</font></p>
<p>Also see the <a class="reference external" href="http://www.boost.org/doc/html/bbv2/installation.html">official installation instructions</a>.</p>
<p><font color="#0000E3">详见 <a class="reference external" href="http://www.boost.org/doc/html/bbv2/installation.html">官方安装说明</font></a>.</p>
</div>
<div class="section" id="step-3-building-libtorrent">
<h3>Step 3: Building libtorrent (步骤3: 构建 libtorrent)</h3>
<p>When building libtorrent, the <tt class="docutils literal">Jamfile</tt> expects the environment variable
<tt class="docutils literal">BOOST_ROOT</tt> to be set to the boost installation directory. It uses this to
find the boost libraries it depends on, so they can be built and their headers
files found. So, set this to <tt class="docutils literal"><span class="pre">c:\boost_1_34_0</span></tt>. You only need this if you're
building against a source distribution of boost.</p>
<p><font color="#0000E3">构建 libtorrent 时, <tt class="docutils literal">Jamfile</tt> 要求环境变量
<tt class="docutils literal">BOOST_ROOT</tt> 设置为 boost 安装目录. 它根据这个去查找所依赖的 boost 库, 这样就可以构建而且也可以找到头文件. 因此, 将其设置为 <tt class="docutils literal"><span class="pre">c:\boost_1_34_0</span></tt>. 仅仅当通过 boost 源码构建时需要这样做.</font></p>
<p>Then the only thing left is simply to invoke <tt class="docutils literal">bjam</tt>. If you want to specify
a specific toolset to use (compiler) you can just add that to the commandline.
For example:</p>
<p><font color="#0000E3">现在唯一要做的就是简单的执行 <tt class="docutils literal">bjam</tt>. 如果你想一个工具集来使用 (编译器) 只需添加到命令行.
例如:</font></p>
<pre class="literal-block">
bjam msvc-7.1 boost=source
bjam gcc-3.3 boost=source
bjam darwin-4.0 boost=source
</pre>
<p>If you're building against a system installed boost, specify <tt class="docutils literal">boost=system</tt>.</p>
<p><font color="#0000E3">如果构建时要使用系统自带的 boost, 指定 <tt class="docutils literal">boost=system</tt>.</font></p>
<p>To build different versions you can also just add the name of the build
variant. Some default build variants in BBv2 are <tt class="docutils literal">release</tt>, <tt class="docutils literal">debug</tt>,
<tt class="docutils literal">profile</tt>.</p>
<p><font color="#0000E3">如果要构建多个版本的话你也可以通过变量添加构建的名称. 在BBv2的一些默认构的建变量是 <tt class="docutils literal">release</tt>, <tt class="docutils literal">debug</tt>,
<tt class="docutils literal">profile</tt>.</font></p>
<p>You can build libtorrent as a dll too, by typing <tt class="docutils literal">link=shared</tt>, or
<tt class="docutils literal">link=static</tt> to build a static library.</p>
<p><font color="#0000E3">你也可以将 libtorrent 构建为动态库, 通过指定 <tt class="docutils literal">link=shared</tt>, 或者
<tt class="docutils literal">link=static</tt> 来构建静态库.</font></p>
<p>If you want to explicitly say how to link against the runtime library, you
can set the <tt class="docutils literal"><span class="pre">runtime-link</span></tt> feature on the commandline, either to <tt class="docutils literal">shared</tt>
or <tt class="docutils literal">static</tt>. Most operating systems will only allow linking shared against
the runtime, but on windows you can do both. Example:</p>
<p><font color="#0000E3">如果你要显式指定链接的运行时库, 你可以通过命令行设置为 <tt class="docutils literal"><span class="pre">runtime-link</span></tt> 属性, 为 <tt class="docutils literal">shared</tt>
或者 <tt class="docutils literal">static</tt>. 大部分的操作系统只允许链接动态运行时库, 但是在 Windows 上你可以链接静态运行时库. 例如:</font></p>
<pre class="literal-block">
bjam msvc-7.1 link=static runtime-link=static boost=source
</pre>
<div class="note">
<p class="first admonition-title">Note (注意)</p>
<p class="last">When building on windows, the path boost-build puts targets in may be too
long. If you get an error message like: &quot;The input line is long&quot;, try to
pass --abbreviate-paths on the bjam command line.</p>
<p class="last"><font color="#0000E3">在 Windows 上构建时, 将对象放置 boost-build 目录可能会太长. 如果你碰到这样的错误消息: &quot;The input line is long&quot;, 可以尝试用 --abbreviate-paths 这个 bjam 命令行参数.</font></p>
</div>
<div class="warning">
<p class="first admonition-title">Warning (警告)</p>
<p class="last">If you link statically to the runtime library, you cannot build libtorrent
as a shared library (DLL), since you will get separate heaps in the library
and in the client application. It will result in crashes and possibly link
errors.</p>
<p class="last"><font color="#0000E3">如果你静态链接运行时库, 你不能构建动态库形式的 libtorrent, 因为这样会使得库和应用程序的堆互相独立. 这样将导致崩溃或者链接错误.</font></p>
</div>
<div class="note">
<p class="first admonition-title">Note (注意)</p>
<p class="last">With boost-build V2 (Milestone 11), the darwin toolset uses the <tt class="docutils literal"><span class="pre">-s</span></tt> linker
option to strip debug symbols. This option is buggy in Apple's GCC, and
will make the executable crash on startup. On Mac OS X, instead build
your release executables with the <tt class="docutils literal"><span class="pre">debug-symbols=on</span></tt> option, and
later strip your executable with <tt class="docutils literal">strip</tt>.</p>
<p class="last"><font color="#0000E3">通过 boost-build V2 (Milestone 11), darwin 工具集使用 <tt class="docutils literal"><span class="pre">-s</span></tt> 链接选项
来去除调试信息. 在苹果的 GCC 上这个选项是有问题的, 会导致可执行程序在启动时崩溃. 在 Mac OS X 上, 可以替换成 <tt class="docutils literal"><span class="pre">debug-symbols=on</span></tt> 选项, 或者
<tt class="docutils literal">strip</tt>.</font></p>
</div>
<div class="note">
<p class="first admonition-title">Note (注意)</p>
<p class="last">Some linux systems requires linking against <tt class="docutils literal">librt</tt> in order to access
the POSIX clock functions. If you get an error complaining about a missing
symbol <tt class="docutils literal">clock_gettime</tt>, you have to give <tt class="docutils literal"><span class="pre">need-librt=yes</span></tt> on the
bjam command line. This will make libtorrent link against <tt class="docutils literal">librt</tt>.</p>
<p class="last"><font color="#0000E3">某些 linux 操作系统需要链接 <tt class="docutils literal">librt</tt> 因为要使用 POSIX clock 函数. 如果你碰到抱怨找不到符号 <tt class="docutils literal">clock_gettime</tt> 的错误, 你需要添加 <tt class="docutils literal"><span class="pre">need-librt=yes</span></tt> 到
bjam 命令行. 这样 libtorrent 就会去链接 <tt class="docutils literal">librt</tt>.</font></p>
</div>
<div class="note">
<p class="first admonition-title">Note (注意)</p>
<p class="last">When building on Solaris, you might have to specify <tt class="docutils literal"><span class="pre">stdlib=sun-stlport</span></tt>
on the bjam command line.</p>
<p class="last"><font color="#0000E3">在 Solaris 上构建时, 你可能需要指定 <tt class="docutils literal"><span class="pre">stdlib=sun-stlport</span></tt>
到 bjam 命令行.</font></p>
</div>
<p>The build targets are put in a directory called bin, and under it they are
sorted in directories depending on the toolset and build variant used.</p>
<p><font color="#0000E3">构建结果放置到 bin 目录下, 然后在这个目录下根据工具集和构建变量顺序创建目录.</font></p>
<p>To build the examples, just change directory to the examples directory and
invoke <tt class="docutils literal">bjam</tt> from there. To build and run the tests, go to the test
directory and run <tt class="docutils literal">bjam</tt>.</p>
<p><font color="#0000E3">如果要构建例程, 只需切换到例程目录然后执行 <tt class="docutils literal">bjam</tt> 即可.
	 要构建以及运行测试例程的话, 切换到测试例程目录然后执行 <tt class="docutils literal">bjam</tt>.</font></p>	
<p>Note that if you're building on windows using the <tt class="docutils literal">msvc</tt> toolset, you cannot run it
from a cygwin terminal, you'll have to run it from a <tt class="docutils literal">cmd</tt> terminal. The same goes for
cygwin, if you're building with gcc in cygwin you'll have to run it from a cygwin terminal.
Also, make sure the paths are correct in the different environments. In cygwin, the paths
(<tt class="docutils literal">BOOST_BUILD_PATH</tt> and <tt class="docutils literal">BOOST_ROOT</tt>) should be in the typical unix-format (e.g.
<tt class="docutils literal">/cygdrive/c/boost_1_34_0</tt>). In the windows environment, they should have the typical
windows format (<tt class="docutils literal"><span class="pre">c:/boost_1_34_0</span></tt>).</p>
<p><font color="#0000E3">如果在 Windows 上使用 <tt class="docutils literal">msvc</tt> 工具集的话需要注意一些事情, 你不能使用 cygwin 终端, 只能用 <tt class="docutils literal">cmd</tt> 终端. 
对于 cygwin 也是一样的, 如果在 cygwin 使用 gcc 那么必须使用 cygwin 终端.
而且, 要确保有各自的环境变量. 在 cygwin 下, 
(<tt class="docutils literal">BOOST_BUILD_PATH</tt> 以及 <tt class="docutils literal">BOOST_ROOT</tt>) 应该是 unix-format (e.g.
<tt class="docutils literal">/cygdrive/c/boost_1_34_0</tt>). 而 Windows 环境变量, 应该是
Windows format (<tt class="docutils literal"><span class="pre">c:/boost_1_34_0</span></tt>).</font></p>
<div class="note">
<p class="first admonition-title">Note (注意)</p>
<p class="last">In Jamfiles, spaces are separators. It's typically easiest to avoid spaces
in path names. If you want spaces in your paths, make sure to quote them
with double quotes (&quot;).</p>
<p class="last"><font color="#0000E3">在 Jamfiles 中, 空格是分隔符. 通常要避免路径包含空格. 如果你的路径有空格, 要用 (&quot;) 括起来.</font></p>
</div>
<p>The <tt class="docutils literal">Jamfile</tt> will define <tt class="docutils literal">NDEBUG</tt> when it's building a release build.
For more build configuration flags see <a class="reference internal" href="#build-configurations">Build configurations</a>.</p>
<p><font color="#0000E3"><tt class="docutils literal">Jamfile</tt> 会定义 <tt class="docutils literal">NDEBUG</tt> 宏如果
是构建释出版的话.
更多构建配置标志可以看 <a class="reference internal" href="#build-configurations">构建选项</a>.</font></p>
<p>Build features:</p>
<p><font color="#0000E3">构建属性:</font></p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">boost build feature (boost 构建属性)</th>
<th class="head">values (配置值)</th>
</tr>
</thead>
<tbody valign="top">
<tr><td><tt class="docutils literal">boost</tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">system</tt> - default. Tells the Jamfile that
boost is installed and should be linked against
the system libraries.</li>
<li><font color="#0000E3"><tt class="docutils literal">system</tt> - 默认选项. 告诉 Jamfile boost 库可以直接链接系统已安装的.</font></li>
<li><tt class="docutils literal">source</tt> - Specifies that boost is to be built
from source. The environment variable
<tt class="docutils literal">BOOST_ROOT</tt> must be defined to point to the
boost directory.</li>
<li><font color="#0000E3"><tt class="docutils literal">source</tt> - 说明 boost 从源码构建. 环境变量
<tt class="docutils literal">BOOST_ROOT</tt> 必须指定到 boost 目录.</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">boost-link</span></tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">static</tt> - links statically against the boost
libraries.</li>
<li><font color="#0000E3"><tt class="docutils literal">static</tt> - 静态链接 boost 库.</font></li>
<li><tt class="docutils literal">shared</tt> - links dynamically against the boost
libraries.</li>
<li><font color="#0000E3"><tt class="docutils literal">shared</tt> - 动态链接 boost 库.</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal">logging</tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">none</tt> - no logging.</li>
<li><font color="#0000E3"><tt class="docutils literal">none</tt> - 不记录日志.</font></li>
<li><tt class="docutils literal">default</tt> - basic session logging.</li>
<li><font color="#0000E3"><tt class="docutils literal">default</tt> - 基本的 session 日志.</font></li>
<li><tt class="docutils literal">verbose</tt> - verbose peer wire logging.</li>
<li><font color="#0000E3"><tt class="docutils literal">verbose</tt> - 详细的 peer wire 日志.</font></li>
<li><tt class="docutils literal">errors</tt> - like verbose, but limited to errors.</li>
<li><font color="#0000E3"><tt class="docutils literal">errors</tt> - 详细的错误日志.</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal">dht</tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">on</tt> - build with support for tracker less
torrents and DHT support.</li>
<li><font color="#0000E3"><tt class="docutils literal">on</tt> - 支持无 tracker 服务器模式的 torrents 以及 DHT.</font></li>
<li><tt class="docutils literal">logging</tt> - build with DHT support and verbose
logging of the DHT protocol traffic.</li>
<li><font color="#0000E3"><tt class="docutils literal">logging</tt> - 支持 DHT 并且记录详细的 DHT 协议传输日志.</font></li>
<li><tt class="docutils literal">off</tt> - build without DHT support.</li>
<li><font color="#0000E3"><tt class="docutils literal">off</tt> - 不支持 DHT.</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">need-librt</span></tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">no</tt> - this platform does not need to link
against librt to have POSIX time functions.</li>
<li><font color="#0000E3"><tt class="docutils literal">no</tt> - 在该平台下无需链接 librt 来支持 POSIX time 函数.</font></li>
<li><tt class="docutils literal">yes</tt> - specify this if your linux system
requires you to link against librt.a. This is
typically the case on x86 64 bit systems.</li>
<li><font color="#0000E3"><tt class="docutils literal">yes</tt> - 指定该选项如果你所在的 linux 系统
需要链接 librt.a 的话. 通常是在 x86 64 位的操作系统上才有这种情况.</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal">asserts</tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">auto</tt> - asserts are on if in debug mode</li>
<li><font color="#0000E3"><tt class="docutils literal">auto</tt> - 如果是 debug 模式的话就开启断言</font></li>
<li><tt class="docutils literal">on</tt> - asserts are on, even in release mode</li>
<li><font color="#0000E3"><tt class="docutils literal">on</tt> - 即使是 release 模式也开启断言</font></li>
<li><tt class="docutils literal">off</tt> - asserts are disabled</li>
<li><font color="#0000E3"><tt class="docutils literal">off</tt> - 关闭断言</font></li>
<li><tt class="docutils literal">production</tt> - assertion failures are logged
to <tt class="docutils literal">asserts.log</tt> in the current working
directory, but won't abort the process.
The file they are logged to can be customized
by setting the global pointer <tt class="docutils literal">extern char
const* libtorrent_assert_log</tt> to a different
filename.</li>
<li><font color="#0000E3"><tt class="docutils literal">production</tt> - 断言失败会记录到当前工作目录的 <tt class="docutils literal">asserts.log</tt> 文件中, 不过退出程序就没了.
该文件可以被定制通过设置一个全局的指针 <tt class="docutils literal">extern char
const* libtorrent_assert_log</tt> 重定向到指定的一个文件中去.</font></li>
<li><tt class="docutils literal">system</tt> use the libc assert macro</li>
<li><font color="#0000E3"><tt class="docutils literal">system</tt> 使用 libc 断言宏</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal">geoip</tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">off</tt> - geo ip lookups disabled</li>
<li><font color="#0000E3"><tt class="docutils literal">off</tt> - geo ip 查询禁止</font></li>
<li><tt class="docutils literal">static</tt> - <a class="reference external" href="http://www.maxmind.com/app/api">MaxMind</a> geo ip lookup code linked
in statically. Note that this code is under
LGPL license.</li>
<li><font color="#0000E3"><tt class="docutils literal">static</tt> - <a class="reference external" href="http://www.maxmind.com/app/api">MaxMind</a> geo ip 静态查询. 该部分的源码遵循 LGPL 许可.</font></li>
<li><tt class="docutils literal">shared</tt> - The <a class="reference external" href="http://www.maxmind.com/app/api">MaxMind</a> geo ip lookup library
is expected to be installed on the system and
it will be used.</li>
<li><font color="#0000E3"><tt class="docutils literal">shared</tt> - <a class="reference external" href="http://www.maxmind.com/app/api">MaxMind</a> geo ip 查询库
需要安装到系统中然后它会被使用到.</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">upnp-logging</span></tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">off</tt> - default. Does not log UPnP traffic.</li>
<li><font color="#0000E3"><tt class="docutils literal">off</tt> - 默认选项. 不记录 UPnP 传输日志.</font></li>
<li><tt class="docutils literal">on</tt> - creates &quot;upnp.log&quot; with the messages
sent to and received from UPnP devices.</li>
<li><font color="#0000E3"><tt class="docutils literal">on</tt> - 创建 &quot;upnp.log&quot; 记录与 UPnP 设备收发的消息.</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal">encryption</tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">openssl</tt> - links against openssl and
libcrypto to enable https and encrypted
bittorrent connections.</li>
<li><font color="#0000E3"><tt class="docutils literal">openssl</tt> - 链接 openssl 以及
libcrypto 来开启 https 然后加密
bittorrent 连接.</font></li>
<li><tt class="docutils literal">gcrypt</tt> - links against libgcrypt to enable
encrypted bittorrent connections.</li>
<li><font color="#0000E3"><tt class="docutils literal">gcrypt</tt> - 链接 libgcrypt 来
加密 bittorrent 连接.</font></li>
<li><tt class="docutils literal">tommath</tt> - uses a shipped version of
libtommath and a custom rc4 implementation
(based on libtomcrypt). This is the default
option.</li>
<li><font color="#0000E3"><tt class="docutils literal">tommath</tt> - 使用打包版本的 libtommath 以及可定制的 rc4 实现
(基于 libtomcrypt). 这个是默认选项.</font></li>
<li><tt class="docutils literal">off</tt> - turns off support for encrypted
connections. The shipped public domain SHA-1
implementation is used.</li>
<li><font color="#0000E3"><tt class="docutils literal">off</tt> - 关闭加密连接支持. The shipped public domain SHA-1
implementation is used.</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal">allocator</tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">pool</tt> - default, uses pool allocators for
send buffers.</li>
<li><font color="#0000E3"><tt class="docutils literal">pool</tt> - 默认选项, 对于发送缓冲区使用池分配器.</font></li>
<li><tt class="docutils literal">system</tt> - uses <tt class="docutils literal">malloc()</tt> and <tt class="docutils literal">free()</tt>
instead. Might be useful to debug buffer issues
with tools like electric fence or libgmalloc.</li>
<li><font color="#0000E3"><tt class="docutils literal">system</tt> - 使用 <tt class="docutils literal">malloc()</tt> 和 <tt class="docutils literal">free()</tt>
替代. 使用诸如 electric fence 或者 libgmalloc 这样的工具来调试缓冲区问题或许有用.</font></li>
<li><tt class="docutils literal">debug</tt> - instruments buffer usage to catch
bugs in libtorrent.</li>
<li><font color="#0000E3"><tt class="docutils literal">debug</tt> - 在 libtorrent 中使用缓冲区工具捕获 bugs.</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal">link</tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">static</tt> - builds libtorrent as a static
library (.a / .lib)</li>
<li><font color="#0000E3"><tt class="docutils literal">static</tt> - 构建为静态库 (.a / .lib)</font></li>
<li><tt class="docutils literal">shared</tt> - builds libtorrent as a shared
library (.so / .dll).</li>
<li><font color="#0000E3"><tt class="docutils literal">shared</tt> - 构建为动态库 (.so / .dll).</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">runtime-link</span></tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">static</tt> - links statically against the
run-time library (if available on your
platform).</li>
<li><font color="#0000E3"><tt class="docutils literal">static</tt> - 静态链接运行时库 (如果你的平台允许的话).</font></li>
<li><tt class="docutils literal">shared</tt> - link dynamically against the
run-time library (default).</li>
<li><font color="#0000E3"><tt class="docutils literal">shared</tt> - 动态链接运行时库 (默认).</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal">variant</tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">debug</tt> - builds libtorrent with debug
information and invariant checks.</li>
<li><font color="#0000E3"><tt class="docutils literal">debug</tt> - 构建 libtorrent 时包含调试信息以及常量检查.</font></li>
<li><tt class="docutils literal">release</tt> - builds libtorrent in release mode
without invariant checks and with optimization.</li>
<li><font color="#0000E3"><tt class="docutils literal">release</tt> - 构建 libtorrent 时不包含常量检查并且进行优化.</font></li>
<li><tt class="docutils literal">profile</tt> - builds libtorrent with profile
information.</li>
<li><font color="#0000E3"><tt class="docutils literal">profile</tt> - 构建 libtorrent 时包含 profile 信息.</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">character-set</span></tt></td>
<td><p class="first">This setting will only have an affect on windows.
Other platforms are expected to support UTF-8.</p>
<p class="first"><font color="#0000E3">该配置项只会影响 windows 平台.
其他平台都支持 UTF-8.</font></p>
<ul class="last simple">
<li><tt class="docutils literal">unicode</tt> - The unicode version of the win32
API is used. This is default.</li>
<li><font color="#0000E3"><tt class="docutils literal">unicode</tt> - 使用 win32 unicode 版本
API. 这个是默认配置.</font></li>
<li><tt class="docutils literal">ansi</tt> - The ansi version of the win32 API is
used.</li>
<li><font color="#0000E3"><tt class="docutils literal">ansi</tt> - 使用 win32 ansi 版本
API.</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">invariant-checks</span></tt></td>
<td><p class="first">This setting only affects debug builds (where
<tt class="docutils literal">NDEBUG</tt> is not defined). It defaults to <tt class="docutils literal">on</tt>.</p>
<p class="first"><font color="#0000E3">这个配置项只会影响 debug 模式的构建 (当
<tt class="docutils literal">NDEBUG</tt> 没有被定义时). 这个默认开启 <tt class="docutils literal">on</tt>.</font></p>
<ul class="last simple">
<li><tt class="docutils literal">on</tt> - internal invariant checks are enabled.</li>
<li><font color="#0000E3"><tt class="docutils literal">on</tt> - 开启内部常量检查.</font></li>
<li><tt class="docutils literal">off</tt> - internal invariant checks are
disabled. The resulting executable will run
faster than a regular debug build.</li>
<li><font color="#0000E3"><tt class="docutils literal">off</tt> - 关闭内部常量检查. 效果是执行更快.</font></li>
<li><tt class="docutils literal">full</tt> - turns on extra expensive invariant
checks.</li>
<li><font color="#0000E3"><tt class="docutils literal">full</tt> - 开启额外的耗费高昂的常量检查.</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">debug-symbols</span></tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">on</tt> - default for debug builds. This setting
is useful for building release builds with
symbols.</li>
<li><font color="#0000E3"><tt class="docutils literal">on</tt> - debug 模式的构建下默认开启. 该配置对 release 模式的构建也有用.</font></li>
<li><tt class="docutils literal">off</tt> - default for release builds.</li>
<li><font color="#0000E3"><tt class="docutils literal">off</tt> - release 模式的构建下默认关闭.</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">deprecated-functions</span></tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">on</tt> - default. Includes deprecated functions
of the API (might produce warnings during build
when deprecated functions are used).</li>
<li><font color="#0000E3"><tt class="docutils literal">on</tt> - 默认开启. 包括 API 里面的弃用函数 (如果在构建时使用弃用函数可能会产生警告信息).</font></li>
<li><tt class="docutils literal">off</tt> - excludes deprecated functions from the
API. Generates build errors when deprecated
functions are used.</li>
<li><font color="#0000E3"><tt class="docutils literal">off</tt> - 从 API 里面排除弃用函数. 如果使用构建时将会出错.</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">full-stats</span></tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">on</tt> - default, collects stats for IP overhead
and DHT and trackers. This uses a little bit
extra memory for each peer and torrent.</li>
<li><font color="#0000E3"><tt class="docutils literal">on</tt> - 默认开启, 收集 IP层 以及 DHT 以及 trackers 的状态. 每个 peer 以及 torrent 仅会多使用一点点额外的内存.</font></li>
<li><tt class="docutils literal">off</tt> - only collects the standard stats for
upload and download rate.</li>
<li><font color="#0000E3"><tt class="docutils literal">off</tt> - 仅仅收集上传速率以及下载速率这些标准状态.</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal">iconv</tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">auto</tt> - use iconv for string conversions for
linux and mingw and other posix platforms.</li>
<li><font color="#0000E3"><tt class="docutils literal">auto</tt> - 使用 iconv 进行字符串转换, 在 linux 以及 mingw 以及其他 posix 平台.</font></li>
<li><tt class="docutils literal">on</tt> - force use of iconv</li>
<li><font color="#0000E3"><tt class="docutils literal">on</tt> - 强制使用</font></li>
<li><tt class="docutils literal">off</tt> - force not using iconv (disables locale
awareness except on windows).</li>
<li><font color="#0000E3"><tt class="docutils literal">off</tt> - 不使用 iconv (关闭区域感知, 特别是在 windows 上).</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal">i2p</tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">on</tt> - build with I2P support</li>
<li><font color="#0000E3"><tt class="docutils literal">on</tt> - 构建时添加 I2P 支持</font></li>
<li><tt class="docutils literal">off</tt> - build without I2P support</li>
<li><font color="#0000E3"><tt class="docutils literal">off</tt> - 构建时不添加 I2P 支持</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">boost-date-time</span></tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">off</tt> - don't build asio types that depend
on boost.date_time. libtorrent doesn't use them
but if the client does, you need these to be
built.</li>
<li><font color="#0000E3"><tt class="docutils literal">off</tt> - 不要构建基于 boost.date_time 的 asio 类型的日期. libtorrent 不使用它们但是如果想要用的话, 你需要去构建它.</font></li>
<li><tt class="docutils literal">on</tt> - build asio types that depend on
boost.date_time.</li>
<li><font color="#0000E3"><tt class="docutils literal">on</tt> - 构建基于 boost.date_time 的 asio 类型的日期.</font></li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal">statistics</tt></td>
<td><ul class="first last simple">
<li><tt class="docutils literal">off</tt> - default. No logging of additional
stats.</li>
<li><font color="#0000E3"><tt class="docutils literal">off</tt> - 默认关闭. 不要记录额外的状态日志.</font></li>
<li><tt class="docutils literal">on</tt> - log session statistics in current
working directory session_stats&lt;pid&gt;. The log
is rotated every hour. It can be parsed by the
parse_session_stats.py script (requires gnuplot)</li>
<li><font color="#0000E3"><tt class="docutils literal">on</tt> - 在当前工作目录记录 session 状态日志 session_stats&lt;pid&gt;. 该日志每小时切割一次. 它可以通过
parse_session_stats.py 这个脚本进行解析 (需要 gnuplot)</font></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The <tt class="docutils literal">variant</tt> feature is <em>implicit</em>, which means you don't need to specify
the name of the feature, just the value.</p>
<p><font color="#0000E3"><tt class="docutils literal">variant</tt> 功能是<em>内置的</em>, 这意味着你不必指定功能的名称, 配置选项值即可.</font></p>
<p>The logs created when building vlog or log mode are put in a directory called
<tt class="docutils literal">libtorrent_logs</tt> in the current working directory.</p>
<p><font color="#0000E3">日志文件将存放在当前工作目录
<tt class="docutils literal">libtorrent_logs</tt>.</font></p>
<p>When building the example client on windows, you need to build with
<tt class="docutils literal">link=static</tt> otherwise you may get unresolved external symbols for some
boost.program-options symbols.</p>
<p><font color="#0000E3">在 windows 上客户端例程时, 你需要使用静态链接 
<tt class="docutils literal">link=static</tt> 的方式, 否则你也许会碰到一些关于 boost.program-options 的无法解析的外部符号的问题.</font></p>
<p>For more information, see the <a class="reference external" href="http://www.boost.org/tools/build/v2/index.html">Boost build v2 documentation</a>, or more
specifically <a class="reference external" href="http://www.boost.org/doc/html/bbv2/reference.html#bbv2.advanced.builtins.features">the section on builtin features</a>.</p>
<p><font color="#0000E3">更多信息, 访问 <a class="reference external" href="http://www.boost.org/tools/build/v2/index.html">Boost build v2 documentation</a>, 或者更多专题
 <a class="reference external" href="http://www.boost.org/doc/html/bbv2/reference.html#bbv2.advanced.builtins.features">the section on builtin features</a>.</font></p>
</div>
</div>
<div class="section" id="building-with-autotools">
<h2>building with autotools (使用 autotools 构建)</h2>
<p>First of all, you need to install <tt class="docutils literal">automake</tt> and <tt class="docutils literal">autoconf</tt>. Many
unix/linux systems comes with these preinstalled.</p>
<p><font color="#0000E3">首先, 你需要安装 <tt class="docutils literal">automake</tt> 和 <tt class="docutils literal">autoconf</tt>. 大多数 unix/linux 系统已经预装.</font></p>
<p>The prerequisites for building libtorrent are boost.thread, boost.date_time
and boost.filesystem. Those are the <em>compiled</em> boost libraries needed. The
headers-only libraries needed include (but is not necessarily limited to)
boost.bind, boost.ref, boost.multi_index, boost.optional, boost.lexical_cast,
boost.integer, boost.iterator, boost.tuple, boost.array, boost.function,
boost.smart_ptr, boost.preprocessor, boost.static_assert.</p>
<p><font color="#0000E3">构建 libtorrent 时需要 boost.thread, boost.date_time
以及 boost.filesystem 这三个库. 这些都是<em>已编译的</em> boost 库所需要的. 仅需要头文件的库包括 (但不仅限于此)
boost.bind, boost.ref, boost.multi_index, boost.optional, boost.lexical_cast,
boost.integer, boost.iterator, boost.tuple, boost.array, boost.function,
boost.smart_ptr, boost.preprocessor, boost.static_assert.</font></p>
<p>If you want to build the <tt class="docutils literal">client_test</tt> example, you'll also need boost.regex
and boost.program_options.</p>
<p><font color="#0000E3">如果你想构建 <tt class="docutils literal">client_test</tt> 这个例程, 你还需要 boost.regex
and boost.program_options.</font></p>
<div class="section" id="step-1-generating-the-build-system">
<h3>Step 1: Generating the build system(步骤1: 生成构建系统)</h3>
<p>No build system is present if libtorrent is checked out from CVS - it
needs to be generated first. If you're building from a released tarball,
you may skip directly to <a class="reference internal" href="#step-2-running-configure">Step 2: Running configure</a>.</p>
<p><font color="#0000E3">目前如果 libtorrent 从 CVS 检出的话是没有构建系统的 - 需要先生成. 如果你是从释出包构建的话可以直接跳到 <a class="reference internal" href="#step-2-running-configure">步骤2: 执行配置</a>.</font></p>
<p>Execute the following command to generate the build system:</p>
<p><font color="#0000E3">执行以下命令生成构建系统:</font></p>
<pre class="literal-block">
./autotool.sh
</pre>
</div>
<div class="section" id="step-2-running-configure">
<h3>Step 2: Running configure</h3>
<p>In your shell, change directory to the libtorrent directory and run
<tt class="docutils literal">./configure</tt>. This will look for libraries and C++ features that libtorrent
is dependent on. If something is missing or can't be found it will print an
error telling you what failed.</p>
<p><font color="#0000E3">在你的 shell 下面, 切换到 libtorrent 源码目录然后执行
<tt class="docutils literal">./configure</tt>. 它会查找编译 libtorrent 依赖的库以及 C++ 特性. 如果有东西丢失或者找不到将会输出错误消息告诉你因为什么失败了.</font></p>
<p>The most likely problem you may encounter is that the configure script won't
find the boost libraries. Make sure you have boost installed on your system.
The easiest way to install boost is usually to use the preferred package
system on your platform. Usually libraries and headers are installed in
standard directories where the compiler will find them, but sometimes that
may not be the case. For example when installing boost on darwin using
darwinports (the package system based on BSD ports) all libraries are
installed to <tt class="docutils literal">/opt/local/lib</tt> and headers are installed to
<tt class="docutils literal">/opt/local/include</tt>. By default the compiler will not look in these
directories. You have to set the enviornment variables <tt class="docutils literal">LDFLAGS</tt> and
<tt class="docutils literal">CXXFLAGS</tt> in order to make the compiler find those libs. In this example
you'd set them like this:</p>
<p><font color="#0000E3">最有可能出现的问题是你会遇到配置脚本找不到 boost 库. 确保你的系统上已经安装了 boost 库.
安装 boost 库的最简单方式通常是使用相应平台提供的包安装系统. 通常库和头文件会被安装在标准目录以便于编译器查找, 但不排除例外. 例如在 darwin 上使用 darwinports 安装 boost (基于 BSD ports 的包安装系统) 所有库被
安装到 <tt class="docutils literal">/opt/local/lib</tt> 然后头文件被安装到 <tt class="docutils literal">/opt/local/include</tt>. 编译器默认不查找这些目录. 你不得不设置环境变量 <tt class="docutils literal">LDFLAGS</tt> 和
<tt class="docutils literal">CXXFLAGS</tt> 使得编译器能够找到这些库. 这个例子说明你可以像这样设置环境变量:</font></p>
<pre class="literal-block">
export LDFLAGS=-L/opt/local/lib
export CXXFLAGS=-I/opt/local/include
</pre>
<p>It was observed on FreeBSD (release 6.0) that one needs to add '-lpthread' to
LDFLAGS, as Boost::Thread detection will fail without it, even if
Boost::Thread is installed.</p>
<p><font color="#0000E3">在 FreeBSD (release 6.0) 上 '-lpthread' 被保留, 需要添加 '-lpthread' 到
LDFLAGS, 因为 Boost::Thread 检测会失败, 即使
Boost::Thread 已经安装.</font></p>
<p>If you need to set these variables, it may be a good idea to add those lines
to your <tt class="docutils literal"><span class="pre">~/.profile</span></tt> or <tt class="docutils literal"><span class="pre">~/.tcshrc</span></tt> depending on your shell.</p>
<p><font color="#0000E3">如果你要设置这些变量的话, 添加到你 shell 的 <tt class="docutils literal"><span class="pre">~/.profile</span></tt> 或者 <tt class="docutils literal"><span class="pre">~/.tcshrc</span></tt> 是个不错的选择.</font></p>
<p>If the boost libraries are named with a suffix on your platform, you may use
the <tt class="docutils literal"><span class="pre">--with-boost-thread=</span></tt> option to specify the suffix used for the thread
library in this case. For more information about these options, run:</p>
<p><font color="#0000E3">如果你所在平台的 boost 库命名带有后缀, 你需要使用
 <tt class="docutils literal"><span class="pre">--with-boost-thread=</span></tt> 选项来指定需要的后缀. 更多选项信息, 运行:</font></p>
<pre class="literal-block">
./configure --help
</pre>
<p>On gentoo the boost libraries that are built with multi-threading support have
the suffix <tt class="docutils literal">mt</tt>.</p>
<p><font color="#0000E3">在 gentoo 上 boost 库支持多线程的有 <tt class="docutils literal">mt</tt> 这个后缀.</font></p>
<p>You know that the boost libraries were found if you see the following output
from the configure script:</p>
<p><font color="#0000E3">如果你看到输出以下信息的话那么说明 boost 库可以找到:</font></p>
<pre class="literal-block">
checking whether the Boost::DateTime library is available... yes
checking for main in -lboost_date_time... yes
checking whether the Boost::Filesystem library is available... yes
checking for main in -lboost_filesystem... yes
checking whether the Boost::Thread library is available... yes
checking for main in -lboost_thread... yes
</pre>
<p>Another possible source of problems may be if the path to your libtorrent
directory contains spaces. Make sure you either rename the directories with
spaces in their names to remove the spaces or move the libtorrent directory.</p>
<p><font color="#0000E3">另一个可能的问题来源是 libtorrent 目录名称包含空格. 确保 libtorrent 目录名称没有空格.</font></p>
</div>
<div class="section" id="creating-a-debug-build">
<h3>Creating a debug build(创建调试版本)</h3>
<p>To tell configure to build a debug version (with debug info, asserts
and invariant checks enabled), you have to run the configure script
with the following option:</p>
<p><font color="#0000E3">让 configure 知道如何去构建一个调试版本 (包含调试信息, 断言以及开启常量检查), 你执行 configure 脚本时要包含以下配置项:</font></p>
<pre class="literal-block">
./configure --enable-debug=yes
</pre>
</div>
<div class="section" id="creating-a-release-build">
<h3>Creating a release build(创建释出版本)</h3>
<p>To tell the configure to build a release version (without debug info,
asserts and invariant checks), you have to run the configure script
with the following option:</p>
<p><font color="#0000E3">让 configure 知道如何去构建一个释出版本 (不包含调试信息, 断言以及开启常量检查), 你执行 configure 脚本时要包含以下配置项:</font></p>
<pre class="literal-block">
./configure --enable-debug=no
</pre>
<p>The above option make use of -DNDEBUG, which is used throughout libtorrent.</p>
<p><font color="#0000E3">以上配置项在 libtorrent 中可以使用 -DNDEBUG.</font></p>
</div>
<div class="section" id="id7">
<h3>Step 3: Building libtorrent(构建 libtorrent)</h3>
<p>Once the configure script is run successfully, you just type <tt class="docutils literal">make</tt> and
libtorrent, the examples and the tests will be built.</p>
<p><font color="#0000E3">一旦配置脚本运行成功之后, 你只要输入 <tt class="docutils literal">make</tt> 然后
libtorrent 以及例程以及测试代码就会被构建.</font></p>
<p>When libtorrent is built it may be a good idea to run the tests, you do this
by running <tt class="docutils literal">make check</tt>.</p>
<p><font color="#0000E3">libtorrent 构建完成之后运行一下测试代码也许是个不错的主意, 你只需要执行 <tt class="docutils literal">make check</tt>.</font></p>
<p>If you want to build a release version (without debug info, asserts and
invariant checks), you have to rerun the configure script and rebuild, like this:</p>
<p><font color="#0000E3">如果你想构建一个释出版本 (不包含调试信息, 断言以及开启常量检查), 你需要重新执行配置脚本然后重新构建, 如下操作:</font></p>
<pre class="literal-block">
./configure --disable-debug
make clean
make
</pre>
</div>
</div>
<div class="section" id="building-with-other-build-systems">
<h2>building with other build systems(使用其他构建系统来构建)</h2>
<p>If you're building in MS Visual Studio, you may have to set the compiler
options &quot;force conformance in for loop scope&quot;, &quot;treat wchar_t as built-in
type&quot; and &quot;Enable Run-Time Type Info&quot; to Yes.</p>
<p><font color="#0000E3">如果你在用 MS Visual Studio 进行构建, 你可能不得不去设置编译器选项 &quot;force conformance in for loop scope&quot;, &quot;treat wchar_t as built-in
type&quot; 以及 &quot;Enable Run-Time Type Info&quot; 为开启状态.</font></p>
</div>
<div class="section" id="build-configurations">
<h2>build configurations(构建相关的配置选项)</h2>
<p>By default libtorrent is built In debug mode, and will have pretty expensive
invariant checks and asserts built into it. If you want to disable such checks
(you want to do that in a release build) you can see the table below for which
defines you can use to control the build.</p>
<p><font color="#0000E3">By default libtorrent is built In debug mode, and will have pretty expensive
invariant checks and asserts built into it. If you want to disable such checks
(you want to do that in a release build) you can see the table below for which
defines you can use to control the build.</font></p>
<table border="1" class="docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">macro</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr><td><tt class="docutils literal">NDEBUG</tt></td>
<td>If you define this macro, all asserts,
invariant checks and general debug code will be
removed. Since there is quite a lot of code in
in header files in libtorrent, it may be
important to define the symbol consistently
across compilation units, including the clients
files. Potential problems is different
compilation units having different views of
structs and class layouts and sizes.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">如果你定义了这个宏, 所有断言,
常量检查以及一般的调试代码将会被移除. 由于有相当一部分的源码在 libtorrent 的头文件中, 在固定的跨平台汇编单元以及客户端文件中定义这个宏也许是重要的. 
潜在的问题是不同的汇编单元有不同的结构视图以及类的布局和大小.</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_LOGGING</tt></td>
<td>This macro will enable logging of the session
events, such as tracker announces and incoming
connections (as well as blocked connections).</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">这个宏开启后将记录 session
事件, 例如 tracker announces 以及传入连接 (还有被阻塞的连接).</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_DISABLE_GEO_IP</tt></td>
<td>This is defined by default by the Jamfile. It
disables the GeoIP features, and avoids linking
against LGPL:ed code.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">Jamfile 会默认定义这个宏. 这个将关闭 GeoIP 功能, 然后避免链接 LGPL:ed 源码.</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_VERBOSE_LOGGING</tt></td>
<td>If you define this macro, every peer connection
will log its traffic to a log file as well as
the session log.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">如果你定义了这个宏, 每一个 peer 连接
将会记录它的通信日志到 session 日志文件里面.</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_STORAGE_DEBUG</tt></td>
<td>This will enable extra expensive invariant
checks in the storage, including logging of
piece sorting.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">这将耗费额外的高昂花销在存储方面的常量检查, 包括记录分片排序.</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_UPNP_LOGGING</tt></td>
<td>Generates a &quot;upnp.log&quot; file with the UPnP
traffic. This is very useful when debugging
support for various UPnP routers.
support for various UPnP routers.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">产生 &quot;upnp.log&quot; 文件来记录 UPnP
通信日志. 当调试对各种 UPnP 路由的支持时这个很有用.</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_DISK_STATS</tt></td>
<td>This will create a log of all disk activity
which later can parsed and graphed using
<tt class="docutils literal">parse_disk_log.py</tt>.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">这个将产生一个日志文件, 用来记录所有的磁盘活动然后可以使用
<tt class="docutils literal">parse_disk_log.py</tt> 这个脚本进行解析和绘图.</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_STATS</tt></td>
<td>This will generate a log with transfer rates,
downloading torrents, seeding torrents, peers,
connecting peers and disk buffers in use. The
log can be parsed and graphed with
<tt class="docutils literal">parse_session_stats.py</tt>.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">这个将产生一个日志文件, 用来记录传输速率,
正在下载的 torrents, 正在做种的 torrents, peers,
连接中的 peers 以及在用的磁盘缓冲区. 这个日志可以被
<tt class="docutils literal">parse_session_stats.py</tt> 这个脚本解析和绘图.</font></td>
</tr>
<tr><td><tt class="docutils literal">UNICODE</tt></td>
<td>If building on windows this will make sure the
UTF-8 strings in pathnames are converted into
UTF-16 before they are passed to the file
operations.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">在 windows 上构建时, 在文件操作之前要确保目录名称中的
UTF-8 字符串被转换成 UTF-16 字符串.</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_DISABLE_POOL_ALLOCATOR</tt></td>
<td>Disables use of <tt class="docutils literal"><span class="pre">boost::pool&lt;&gt;</span></tt>.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">禁用 <tt class="docutils literal"><span class="pre">boost::pool&lt;&gt;</span></tt>.</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_LINKING_SHARED</tt></td>
<td>If this is defined when including the
libtorrent headers, the classes and functions
will be tagged with <tt class="docutils literal">__declspec(dllimport)</tt>
on msvc and default visibility on GCC 4 and
later. Set this in your project if you're
linking against libtorrent as a shared library.
(This is set by the Jamfile when
<tt class="docutils literal">link=shared</tt> is set).</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">如果定义了这个宏, 当包含 libtorrent 头文件时, 类和函数将被标记为 <tt class="docutils literal">__declspec(dllimport)</tt>
, 使用 msvc 以及默认的 GCC 4 或者更高版本. 在你的项目中设置该选项, 如果你要以动态库形式链接 libtorrent 的话.
(这个选项会通过 Jamfile 设置当
<tt class="docutils literal">link=shared</tt> 被配置时).</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_BUILDING_SHARED</tt></td>
<td>If this is defined, the functions and classes
in libtorrent are marked with
<tt class="docutils literal">__declspec(dllexport)</tt> on msvc, or with
default visibility on GCC 4 and later. This
should be defined when building libtorrent as
a shared library. (This is set by the Jamfile
when <tt class="docutils literal">link=shared</tt> is set).</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">如果定义了这个宏, 在 msvc 上, 或者默认的 GCC 4 或者更高版本, 类和函数将被标记为
<tt class="docutils literal">__declspec(dllexport)</tt>. 如果要构建动态库版本的 libtorrent 这个宏需要定义. (这个选项会通过 Jamfile 设置当 <tt class="docutils literal">link=shared</tt> 被配置时).</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_DISABLE_DHT</tt></td>
<td>If this is defined, the support for trackerless
torrents will be disabled.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">如果定义了这个宏, 将不支持无 tracker
模式的 torrents.</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_DHT_VERBOSE_LOGGING</tt></td>
<td>This will enable verbose logging of the DHT
protocol traffic.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">这会记录详细的 DHT 协议通信日志.</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_DISABLE_ENCRYPTION</tt></td>
<td>This will disable any encryption support and
the dependencies of a crypto library.
Encryption support is the peer connection
encrypted supported by clients such as
uTorrent, Azureus and KTorrent.
If this is not defined, either
<tt class="docutils literal">TORRENT_USE_OPENSSL</tt> or
<tt class="docutils literal">TORRENT_USE_GCRYPT</tt> must be defined.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">这会关闭任何加密支持加密库依赖.
加密支持是指客户端支持 peer 连接加密, 例如
uTorrent, Azureus 以及 KTorrent.
如果没有定义的话, 那么
<tt class="docutils literal">TORRENT_USE_OPENSSL</tt> 或者
<tt class="docutils literal">TORRENT_USE_GCRYPT</tt> 必须被定义.</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_DISABLE_EXTENSIONS</tt></td>
<td>When defined, libtorrent plugin support is
disabled along with support for the extension
handskake (BEP 10).</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">定义了这个宏的话, libtorrent 插件支持以及扩展的握手协议 (BEP 10) 将被禁用.</font></td>
</tr>
<tr><td><tt class="docutils literal">_UNICODE</tt></td>
<td>On windows, this will cause the file IO
use wide character API, to properly support
non-ansi characters.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">在 windows 上, 这个宏定义指明文件 IO
将使用宽字符 API, 去正确地适应非 ansi 字符.</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_DISABLE_RESOLVE_COUNTRIES</tt></td>
<td>Defining this will disable the ability to
resolve countries of origin for peer IPs.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">定义这个宏的话将禁用地区和 IP 来源解析.</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_DISABLE_INVARIANT_CHECKS</tt></td>
<td>This will disable internal invariant checks in
libtorrent. The invariant checks can sometime
be quite expensive, they typically don't scale
very well. This option can be used to still
build in debug mode, with asserts enabled, but
make the resulting executable faster.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">定义这个宏的话将禁用 libtorrent 内部常量检查. 常量检查有些时候耗费非常高昂, 这个通常不会使用太多. 
	这个选项在调试模式仍然可以使用, 开启断言, 然而定义这个宏是为了可执行程序执行更快.</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_EXPENSIVE_INVARIANT_CHECKS</tt></td>
<td>This will enable extra expensive invariant
checks. Useful for finding particular bugs
or for running before releases.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">定义这个宏的话将有额外的高昂耗费. 在释出之前, 这个对于查找特殊 bugs 或者运行是有用的.</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_NO_DEPRECATE</tt></td>
<td>This will exclude all deprecated functions from
the header files and cpp files.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">这个将从头文件以及源文件中排除所有弃用函数.</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_PRODUCTION_ASSERTS</tt></td>
<td>Define to either 0 or 1. Enables assert logging
in release builds.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">定义成 0 或者 1. 在释出版本中开启断言日志.</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_USE_ASSERTS</tt></td>
<td>Define as 0 to disable asserts unconditionally.</td>
</tr>
<tr><td></td>
<td><font color="#0000E3">定义成 0 可以无条件禁用断言.</font></td>
</tr>
<tr><td><tt class="docutils literal">TORRENT_USE_SYSTEM_ASSERTS</tt></td>
<td>Uses the libc assert macro rather then the
custom one.</td>
<tr><td></td>
<td><font color="#0000E3">使用 libc 断言宏而不是自定义的.</font></td>
</tr>
</tbody>
</table>
<p>If you experience that libtorrent uses unreasonable amounts of cpu, it will
definitely help to define <tt class="docutils literal">NDEBUG</tt>, since it will remove the invariant checks
within the library.</p>
<p><font color="#0000E3">如果你使用 libtorrent 时发现 cpu 使用很多, 定义 <tt class="docutils literal">NDEBUG</tt> 这个宏有一定的效果, 因为这将移除库里面的常量检查.</font></p>
</div>
<div class="section" id="building-openssl-for-windows">
<h2>building openssl for windows(在 windows 下构建 openssl)</h2>
<p>To build openssl for windows with Visual Studio 7.1 (2003) execute the following commands
in a command shell:</p>
<p><font color="#0000E3">在 windows 使用 Visual Studio 7.1 (2003) 构建 openssl 在命令行下执行以下命令:</font></p>
<pre class="literal-block">
perl Configure VC-WIN32 --prefix=&quot;c:/openssl
call ms\do_nasm
call &quot;C:\Program Files\Microsoft Visual Studio .NET 2003\vc7\bin\vcvars32.bat&quot;
nmake -f ms\nt.mak
copy inc32\openssl &quot;C:\Program Files\Microsoft Visual Studio .NET 2003\vc7\include\&quot;
copy out32\libeay32.lib &quot;C:\Program Files\Microsoft Visual Studio .NET 2003\vc7\lib&quot;
copy out32\ssleay32.lib &quot;C:\Program Files\Microsoft Visual Studio .NET 2003\vc7\lib&quot;
</pre>
<p>This will also install the headers and library files in the visual studio directories to
be picked up by libtorrent.</p>
<p><font color="#0000E3">这也会安装头文件和库文件到 visual studio 目录让 libtorrent 可以使用.</font></p>
</div>
</div>

    </div>
    </div>
    <div id="gradient"></div>
    <div id="footer">
    <table>
    <tr>
      <td><a href="index.html">home</a></td>
      <td><a href="http://blog.libtorrent.org">blog</a></td>
      <td><a href="utp.html">uTP</a></td>
    </tr>
    <tr>
      <td><a href="https://sourceforge.net/projects/libtorrent/files/libtorrent/">download</a></td>
      <td><a href="reference.html">documentation</a></td>
      <td><a href="dht_store.html">DHT put extension</a></td>
    </tr>
    <tr>
      <td><a href="https://sourceforge.net/projects/libtorrent/files/py-libtorrent/">python bindings</a></td>
      <td><a href="features.html">features</a></td>
      <td><a href="dht_sec.html">DHT security extension</a></td>
    </tr>
    <tr>
      <td><a href="http://dir.gmane.org/gmane.network.bit-torrent.libtorrent">mailing list archive</a></td>
      <td><a href="contributing.html">contributing</a></td>
      <td><a href="streaming.html">streaming</a></td>
    </tr>
    <tr>
      <td><a href="http://code.google.com/p/libtorrent/issues/entry">report a bug</a></td>
      <td><a href="building.html">building</a></td>
      <td><a href="bittorrent.pdf">bittorrent slides</a></td>
    </tr>
    </table>
    </div>
    <div id="filler"></div>

</div>
</body>
</html>
